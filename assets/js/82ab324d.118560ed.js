"use strict";(globalThis.webpackChunkapache_website_template=globalThis.webpackChunkapache_website_template||[]).push([[203],{3902(e,n,a){a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>l,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"grafana","title":"grafana","description":"\x3c!--","source":"@site/docs/grafana.md","sourceDirName":".","slug":"/grafana","permalink":"/docs/grafana","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/otava-website/tree/master/docs/grafana.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"CSV","permalink":"/docs/csv"}}');var s=a(2615),r=a(5756);const o={},i="Annotating Change Points in Grafana",c={},d=[{value:"Example",id:"example",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"annotating-change-points-in-grafana",children:"Annotating Change Points in Grafana"})}),"\n",(0,s.jsxs)(n.p,{children:["Change points found by ",(0,s.jsx)(n.code,{children:"analyze"})," can be exported\nas Grafana annotations using the ",(0,s.jsx)(n.code,{children:"--update-grafana"})," flag:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"$ otava analyze <test or group> --update-grafana\n"})}),"\n",(0,s.jsx)(n.p,{children:"The annotations generated by Otava get the following tags:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"otava"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"change-point"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"test:<test name>"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"metric:<metric name>"})}),"\n",(0,s.jsxs)(n.li,{children:["tags configured in the ",(0,s.jsx)(n.code,{children:"tags"})," property of the test"]}),"\n",(0,s.jsxs)(n.li,{children:["tags configured in the ",(0,s.jsx)(n.code,{children:"annotate"})," property of the test"]}),"\n",(0,s.jsxs)(n.li,{children:["tags configured in the ",(0,s.jsx)(n.code,{children:"annotate"})," property of the metric"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Additionally, the ",(0,s.jsx)(n.code,{children:"annotate"})," property supports variable tags:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"%{TEST_NAME}"})," - name of the test"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"%{METRIC_NAME}"})," - name of the metric"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"%{GRAPHITE_PATH}"})," - resolves to the path to the data in Graphite"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"%{GRAPHITE_PATH_COMPONENTS}"})," - splits the path of the data in Graphite into separate components\nand each path component is exported as a separate tag"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"%{GRAPHITE_PREFIX}"})," - resolves to the prefix of the path to the data in Graphite\n(the part of the path up to the metric suffix)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"%{GRAPHITE_PREFIX_COMPONENTS}"})," - similar as ",(0,s.jsx)(n.code,{children:"%{GRAPHITE_PATH_COMPONENTS}"})," but splits the prefix\nof the path instead of the path"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["See ",(0,s.jsx)(n.a,{href:"https://github.com/apache/otava/tree/master/examples/graphite/config/otava.yaml",children:"otava.yaml"})," for the full Graphite & Grafana example."]})}),"\n",(0,s.jsx)(n.p,{children:"Start docker-compose with Graphite in one tab:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker-compose -f examples/graphite/docker-compose.yaml up --force-recreate --always-recreate-deps --renew-anon-volumes\n"})}),"\n",(0,s.jsx)(n.p,{children:"Run otava in another tab:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker-compose -f examples/graphite/docker-compose.yaml run --rm otava analyze my-product.test --since=-10m --update-grafana\n"})}),"\n",(0,s.jsx)(n.p,{children:"Expected output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"time                       run    branch    version    commit      throughput    response_time    cpu_usage\n-------------------------  -----  --------  ---------  --------  ------------  ---------------  -----------\n2024-12-14 22:45:10 +0000                                               61160               87          0.2\n2024-12-14 22:46:10 +0000                                               60160               85          0.3\n2024-12-14 22:47:10 +0000                                               60960               89          0.1\n                                                                 \xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7                   \xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\n                                                                        -5.6%                       +300.0%\n                                                                 \xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7                   \xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\n2024-12-14 22:48:10 +0000                                               57123               88          0.8\n2024-12-14 22:49:10 +0000                                               57980               87          0.9\n2024-12-14 22:50:10 +0000                                               56950               85          0.7\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Open local ",(0,s.jsx)(n.a,{href:"http://localhost:3000",children:"Grafana"})," in your browser (use default ",(0,s.jsx)(n.code,{children:"admin/admin"})," credentials), open\n",(0,s.jsx)(n.code,{children:"Benchmarks"})," dashboard, and see your data points and annotations on both charts.:"]})]})}function l(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},5756(e,n,a){a.d(n,{R:()=>o,x:()=>i});var t=a(9471);const s={},r=t.createContext(s);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);